{"ast":null,"code":"import _regeneratorRuntime from\"/Users/amymiller/Desktop/Cohort 6/My Project/MyTravelProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/amymiller/Desktop/Cohort 6/My Project/MyTravelProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/amymiller/Desktop/Cohort 6/My Project/MyTravelProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SignIn=function SignIn(props){var _useState=useState(\"alice@gmail.com\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"Alice\"),_useState4=_slicedToArray(_useState3,2),firstName=_useState4[0],setFirstName=_useState4[1];var _useState5=useState(\"Britton\"),_useState6=_slicedToArray(_useState5,2),lastName=_useState6[0],setLastName=_useState6[1];var _useState7=useState(\"TBT-1234567\"),_useState8=_slicedToArray(_useState7,2),bookingRef=_useState8[0],setBookingRef=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loginError=_useState10[0],setLoginError=_useState10[1];var signInAPI=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(firstName.length===0||lastName.length===0||email.length===0||bookingRef.length===0){setLoginError(true);//defensive check\n}_context.prev=1;_context.next=4;return axios.post(\"http://api.timbertours.co.uk/login\",{first_name:firstName,last_name:lastName,email:email,booking_ref:bookingRef});case 4:response=_context.sent;localStorage.setItem(\"first_name\",response.data.first_name);localStorage.setItem(\"token\",response.data.token);if(response.data.loginSuccessful){props.setPage(2);}else{setLoginError(true);}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);console.log(_context.t0);//could send to error404 with props here\ncase 13:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function signInAPI(){return _ref.apply(this,arguments);};}();useEffect(function(){window.scrollTo(0,0);},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"signIn\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Sign in to view your booking\"}),/*#__PURE__*/_jsx(\"p\",{className:\"signInP\",children:\"Booking details can be found on your confirmation email\"}),/*#__PURE__*/_jsx(\"p\",{children:\"First Name\"}),/*#__PURE__*/_jsx(\"input\",{id:\"firstName\",value:firstName,type:\"text\",onChange:function onChange(e){return setFirstName(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{children:\"Last Name\"}),/*#__PURE__*/_jsx(\"input\",{id:\"lastName\",value:lastName,type:\"text\",onChange:function onChange(e){return setLastName(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{children:\"Booking Reference\"}),/*#__PURE__*/_jsx(\"input\",{id:\"bookingRef\",value:bookingRef,type:\"text\",placeholder:\"TBT-\",onChange:function onChange(e){return setBookingRef(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{id:\"email\",type:\"email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}})]}),/*#__PURE__*/_jsx(\"button\",{className:\"signInButton\",onClick:function onClick(){return signInAPI();},type:\"submit\",children:\"View My Booking\"}),loginError&&/*#__PURE__*/_jsx(\"h2\",{children:\"Oops. Please check your details and try again.\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"a\",{className:\"signInProblem\",onClick:function onClick(){props.setPage(0);},children:\"Problems Signing In?\"})})]});};export default SignIn;","map":{"version":3,"sources":["/Users/amymiller/Desktop/Cohort 6/My Project/MyTravelProject/src/components/MainPages/SignIn/SignIn.jsx"],"names":["React","useState","useEffect","axios","SignIn","props","email","setEmail","firstName","setFirstName","lastName","setLastName","bookingRef","setBookingRef","loginError","setLoginError","signInAPI","length","post","first_name","last_name","booking_ref","response","localStorage","setItem","data","token","loginSuccessful","setPage","console","log","window","scrollTo","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nconst SignIn = (props) => {\n\tconst [email, setEmail] = useState(\"alice@gmail.com\");\n\tconst [firstName, setFirstName] = useState(\"Alice\");\n\tconst [lastName, setLastName] = useState(\"Britton\");\n\tconst [bookingRef, setBookingRef] = useState(\"TBT-1234567\");\n\tconst [loginError, setLoginError] = useState(false);\n\n\tconst signInAPI = async () => {\n\t\tif (\n\t\t\tfirstName.length === 0 ||\n\t\t\tlastName.length === 0 ||\n\t\t\temail.length === 0 ||\n\t\t\tbookingRef.length === 0\n\t\t) {\n\t\t\tsetLoginError(true); //defensive check\n\t\t}\n\t\ttry {\n\t\t\tconst response = await axios.post(`http://api.timbertours.co.uk/login`, {\n\t\t\t\tfirst_name: firstName,\n\t\t\t\tlast_name: lastName,\n\t\t\t\temail: email,\n\t\t\t\tbooking_ref: bookingRef,\n\t\t\t});\n\n\t\t\tlocalStorage.setItem(\"first_name\", response.data.first_name);\n\t\t\tlocalStorage.setItem(\"token\", response.data.token);\n\t\t\tif (response.data.loginSuccessful) {\n\t\t\t\tprops.setPage(2);\n\t\t\t} else {\n\t\t\t\tsetLoginError(true);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t\t//could send to error404 with props here\n\t\t}\n\t};\n\tuseEffect(() => {\n\t\twindow.scrollTo(0, 0);\n\t}, []);\n\treturn (\n\t\t<>\n\t\t\t<div className=\"signIn\">\n\t\t\t\t<h1>Sign in to view your booking</h1>\n\t\t\t\t<p className=\"signInP\">\n\t\t\t\t\tBooking details can be found on your confirmation email\n\t\t\t\t</p>\n\t\t\t\t<p>First Name</p>\n\t\t\t\t<input\n\t\t\t\t\tid=\"firstName\"\n\t\t\t\t\tvalue={firstName}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tonChange={(e) => setFirstName(e.target.value)}\n\t\t\t\t/>\n\t\t\t\t<p>Last Name</p>\n\t\t\t\t<input\n\t\t\t\t\tid=\"lastName\"\n\t\t\t\t\tvalue={lastName}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tonChange={(e) => setLastName(e.target.value)}\n\t\t\t\t/>\n\t\t\t\t<p>Booking Reference</p>\n\t\t\t\t<input\n\t\t\t\t\tid=\"bookingRef\"\n\t\t\t\t\tvalue={bookingRef}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"TBT-\"\n\t\t\t\t\tonChange={(e) => setBookingRef(e.target.value)}\n\t\t\t\t/>\n\t\t\t\t<p>Email</p>\n\t\t\t\t<input\n\t\t\t\t\tid=\"email\"\n\t\t\t\t\ttype=\"email\"\n\t\t\t\t\tvalue={email}\n\t\t\t\t\tonChange={(e) => setEmail(e.target.value)}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclassName=\"signInButton\"\n\t\t\t\tonClick={() => signInAPI()}\n\t\t\t\ttype=\"submit\"\n\t\t\t>\n\t\t\t\tView My Booking\n\t\t\t</button>\n\t\t\t{loginError && <h2>Oops. Please check your details and try again.</h2>}\n\t\t\t<div>\n\t\t\t\t<a\n\t\t\t\t\tclassName=\"signInProblem\"\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tprops.setPage(0);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tProblems Signing In?\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</>\n\t);\n};\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}